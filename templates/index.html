{% extends "base.html" %}
{% block content %}

<div class="topbar" style="margin:.5rem 0 1rem;">
  <a href="{{ url_for('index', year=prev_year, month=prev_month) }}">â† ä¸Šä¸€æœˆ</a>
  <h3 style="margin:0;">{{ year }} å¹´ {{ "%02d"|format(month) }} æœˆ</h3>
  <a href="{{ url_for('index', year=next_year, month=next_month) }}">ä¸‹ä¸€æœˆ â†’</a>
</div>

<div class="header">
  <div>ä¸€</div><div>äºŒ</div><div>ä¸‰</div><div>å››</div><div>äº”</div><div>å…­</div><div>æ—¥</div>
</div>

<div class="calendar">
  {% for week in weeks %}
    {% for d in week %}
      {% set is_this_month = (d.month == month) %}
      {% set classes = "day" %}
      {% if d == today %}{% set classes = classes + " today" %}{% endif %}
      <div class="{{ classes }}">
        <div class="datebox">
          <a href="{{ url_for('day_view', datestr=d.strftime('%Y-%m-%d')) }}" class="{{ '' if is_this_month else 'muted' }}">{{ d.day }}</a>
          <div style="display:flex; gap:.35rem; align-items:center;">
            {% if d in strength_dates %}
              <!-- é‡è¨“ï¼šç”¨å•éˆ´ emoji æˆ–ç´…è‰²å°é» -->
              <span class="strength-dot" title="ä»Šæ—¥æœ‰é‡è¨“">ğŸ‹ï¸</span>
              <!-- æˆ–æƒ³ä½èª¿ä¸€é»ç”¨å°åœ“é»ï¼š<span class="strength-pill" title="ä»Šæ—¥æœ‰é‡è¨“"></span> -->
            {% endif %}
            <a href="{{ url_for('add', date=d.strftime('%Y-%m-%d')) }}" class="muted">ï¼‹</a>
          </div>
        </div>

        {% for it in items_by_date.get(d, []) %}
          <div class="item">
            <span class="badge">{{ it.item_type }}</span>
            <div class="item-title">{{ it.title }}</div>
            <div><small>{{ it.time_range_str() }}</small></div>
            {% if it.content %}
              <div style="font-size:.85rem; color:#4b5563;">{{ it.content|truncate(60) }}</div>
            {% endif %}
            <div class="actions" style="margin-top:.2rem;">
              <a href="{{ url_for('edit', item_id=it.id) }}" class="secondary">ç·¨è¼¯</a>
              <form action="{{ url_for('delete', item_id=it.id) }}" method="post" style="display:inline;">
                <button class="outline" onclick="return confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')">åˆªé™¤</button>
              </form>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  {% endfor %}
</div>

{% endblock %}
