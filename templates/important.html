{% extends "base.html" %}
{% block content %}

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
  <h3 style="margin: 0;">重要事項追蹤</h3>
  <a href="{{ url_for('add') }}" role="button">＋ 新增事項</a>
</div>

<section>
  {% if items_with_delta|length == 0 %}
    <article class="contrast" style="text-align: center; padding: 2rem;">
      <p>目前尚未新增任何重要事項。</p>
      <a href="{{ url_for('add') }}">去新增第一筆吧！</a>
    </article>
  {% else %}
    <table role="grid">
      <thead>
        <tr>
          <th scope="col">日期</th>
          <th scope="col">標題</th>
          <th scope="col">倒數</th>
          <th scope="col">說明</th>
          <th scope="col">動作</th>
        </tr>
      </thead>
      <tbody>
        {% for it, days_left in items_with_delta %}
          <tr>
            <td>{{ it.date.strftime('%Y-%m-%d') }}</td>
            <td><strong>{{ it.title }}</strong></td>
            <td>
              {% if days_left > 0 %}
                <span style="color: #d93526; font-weight: bold;">還有 {{ days_left }} 天</span>
              {% elif days_left == 0 %}
                <span style="background-color: #d93526; color: white; padding: 2px 6px; border-radius: 4px;">就是今天！</span>
              {% else %}
                <span class="muted">已過 {{ -days_left }} 天</span>
              {% endif %}
            </td>
            <td>{{ it.description or '' }}</td>
            <td>
              <form method="post" action="{{ url_for('important_delete', item_id=it.id) }}" style="margin:0;">
                <button type="submit" 
                        class="secondary outline"
                        style="padding: 5px 10px; font-size: 0.8rem;"
                        onclick="return confirm('確定要刪除此重要事項？');">
                  刪除
                </button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</section>

{% endblock %}